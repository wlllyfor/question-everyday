æœ¬é¢˜éš¾åº¦ï¼šâ­ â­

ç­”ï¼š

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ded58ba7b768497ba63e42552601d21f~tplv-k3u1fbpfcp-watermark.image?)

æ³¨æ„ï¼šä¸Šå›¾åˆ—ä¸¾çš„æ˜¯ä¸€èˆ¬æƒ…å†µï¼Œå¦‚æœä½¿ç”¨ call æˆ–è€… apply çš„åœºæ™¯éè¦ç”¨ bind å»å®ç°ï¼Œè¿”å›ä¸€ä¸ªå‡½æ•°å†æ‰§è¡Œï¼Œä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ï¼Œä¸è¿‡æ²¡å¿…è¦ã€‚

## callã€apply çš„åº”ç”¨åœºæ™¯

call å’Œ apply çš„ä½œç”¨æ˜¯ç›¸åŒçš„ï¼Œåªæ˜¯è°ƒç”¨æ—¶ä¼ å‚å½¢å¼ä¸åŒè€Œå·²ã€‚



### ç²¾å‡†åˆ¤æ–­ä¸€ä¸ªæ•°æ®ç±»å‹

ç²¾å‡†åœ°åˆ¤æ–­ä¸€ä¸ªæ•°æ®çš„ç±»å‹ï¼Œå¯ä»¥ç”¨åˆ° Object.prototype.toString.call(xxx)ã€‚

è°ƒç”¨è¯¥æ–¹æ³•ï¼Œç»Ÿä¸€è¿”å›æ ¼å¼ `[object Xxx]`çš„å­—ç¬¦ä¸²ï¼Œç”¨æ¥è¡¨ç¤ºè¯¥å¯¹è±¡ã€‚

```js
// ç›´æ¥è°ƒç”¨
Object.prototype.toString({})      // '[object Object]'

// åŠ ä¸Š call
// å¼•ç”¨ç±»å‹
Object.prototype.toString.call({})           // '[object Object]'
Object.prototype.toString.call(function(){}) // "[object Function]'
Object.prototype.toString.call(/123/g)       // '[object RegExp]'
Object.prototype.toString.call(new Date())   // '[object Date]'
Object.prototype.toString.call(new Error())  // '[object Error]'
Object.prototype.toString.call([])           // '[object Array]'
Object.prototype.toString.call(new Map())    // '[object Map]'
Object.prototype.toString.call(new Set())    // '[object Set]'
Object.prototype.toString.call(new WeakMap()) // '[object WeakMap]'
Object.prototype.toString.call(new WeakSet()) // '[object WeakSet]'
Object.prototype.toString.call(document)     // '[object HTMLDocument]'
Object.prototype.toString.call(window)       // '[object Window]'
Object.prototype.toString.call(this)         // '[object Window]'

// åŸå§‹ç±»å‹
Object.prototype.toString.call(1)           // '[object Number]'
Object.prototype.toString.call('1')         // '[object String]'
Object.prototype.toString.call(true)        // '[object Boolean]'
Object.prototype.toString.call(1n)          // '[object BigInt]'
Object.prototype.toString.call(null)        // '[object Null]'
Object.prototype.toString.call(undefined)   // '[object Undefined]'
Object.prototype.toString.call(Symbol('a')) // '[object Symbol]'

```

**ä¸ºä»€ä¹ˆè¦è°ƒç”¨ call**

`call` æ˜¯å‡½æ•°çš„æ–¹æ³•ï¼Œç”¨æ¥æ”¹å˜ `this` æŒ‡å‘ï¼Œç”¨ `apply` ä¹Ÿå¯ä»¥ã€‚

å¦‚æœä¸æ”¹å˜`this`æŒ‡å‘ä¸ºæˆ‘ä»¬çš„ç›®æ ‡å˜é‡ï¼Œ`this`å°†æ°¸è¿œæŒ‡å‘è°ƒç”¨çš„`Object.prototype`ã€‚

```js
Object.prototype.toString([])       // '[object Object]'  this æŒ‡å‘ Object.prototypeï¼Œåˆ¤æ–­ç±»å‹ä¸º Objectã€‚
Object.prototype.toString.call([])  // '[object Array]' this æŒ‡å‘ []ï¼Œåˆ¤æ–­ç±»å‹ä¸º Array
```

```js
// é‡å†™ Object.prototype.toString æ–¹æ³•ï¼ŒæŠŠ this æ‰“å°å‡ºæ¥çœ‹ä¸€ä¸‹ï¼Œè¿›ä¸€æ­¥åŠ æ·±ç†è§£
Object.prototype.toStringÂ =Â functionÂ ()Â {
  console.log(this)
}
// å¼•ç”¨ç±»å‹
Object.prototype.toString([])       // Object.prototype
Object.prototype.toString.call([])  // []

// åŸå§‹ç±»å‹
Object.prototype.toString(1)       // Object.prototype
Object.prototype.toString.call(1)  // NumberÂ {1}
// è¿™é‡Œçš„ NumberÂ {1}ï¼Œæ˜¯ä¸€ä¸ªåŒ…è£…ç±»ï¼ŒæŠŠåŸºæœ¬ç±»å‹ç”¨å®ƒä»¬ç›¸åº”çš„å¼•ç”¨ç±»å‹åŒ…è£…èµ·æ¥ï¼Œä½¿å…¶å…·æœ‰å¯¹è±¡çš„æ€§è´¨
```

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/90cae6e6e8ee4537a28860d7b915f018~tplv-k3u1fbpfcp-watermark.image?)

### ä¼ªæ•°ç»„è½¬æ•°ç»„

ä¼ªæ•°ç»„è½¬æ•°ç»„ï¼Œåœ¨ es6 ä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨ Array.prototype.slice.call(xxx)

```js
function add () {
  const args = Array.prototype.slice.call(arguments)
  // ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ const args = [].slice.call(arguments) 
  args.push(1) // å¯ä»¥ä½¿ç”¨æ•°ç»„ä¸Šçš„æ–¹æ³•äº†
}

add(1, 2, 3)
```

**ä¸ºä»€ä¹ˆè¦è°ƒç”¨ call**

å’Œä¸Šæ–‡çš„åˆ¤æ–­æ•°æ®ç±»å‹çš„åŸç†æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœä¸æ”¹å˜`this`æŒ‡å‘ä¸ºç›®æ ‡ä¼ªæ•°ç»„ï¼Œ`this`å°†æ°¸è¿œæŒ‡å‘è°ƒç”¨çš„`Array.prototype`ï¼Œå°±ä¸ä¼šç”Ÿæ•ˆã€‚

**slice æ–¹æ³•åŸç†**

å¾ªç¯ä¼ªæ•°ç»„ï¼ŒæŠŠä¼ªæ•°ç»„çš„å…ƒç´ æŒ¨ä¸ªæ”¾åˆ°å®šä¹‰çš„ä¸€ä¸ªæ–°æ•°ç»„é‡Œï¼Œå†è¿”å›æ–°æ•°ç»„ï¼Œå·®ä¸å¤šæ˜¯ç±»ä¼¼è¿™æ ·çš„ä»£ç ï¼š

```js
// ä» slice æ–¹æ³•åŸç†ç†è§£ä¸ºä»€ä¹ˆè¦è°ƒç”¨ call
Array.prototype.slice = function (start, end) {
  const res = []
  start = start || 0
  end = end || this.length
  for (let i = start; i < end; i++) {
    res.push(this[i]) // è¿™é‡Œçš„ this å°±æ˜¯ä¼ªæ•°ç»„ï¼Œæ‰€ä»¥è¦è°ƒç”¨ call
  }
  return res
}
```
### ES5 å®ç°ç»§æ‰¿

åœ¨ä¸€ä¸ªå­æ„é€ å‡½æ•°ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒç”¨çˆ¶æ„é€ å‡½æ•°çš„Â `call`Â æ–¹æ³•æˆ–è€… `apply` æ–¹æ³•æ¥å®ç°ç»§æ‰¿ã€‚

```js
function Person (name) {
  this.name = name
}

function Student (name, grade) {
  Person.call(this, name)
  this.grade = grade
}

const p1 = new Person('lin')
const s1 = new Student('lin', 100)
```
ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œæ„é€ å‡½æ•° Student ä¸­ä¼šæ‹¥æœ‰æ„é€ å‡½æ•° Person ä¸­çš„ name å±æ€§ï¼Œgrade å±æ€§æ˜¯ Student è‡ªå·±çš„ã€‚

### å›è°ƒå‡½æ•° this ä¸¢å¤±é—®é¢˜

æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå›è°ƒå‡½æ•°ä¼šå¯¼è‡´ this ä¸¢å¤±ã€‚

```js
const obj = {
  lastName: 'lin',
  sayName() {
    console.log(this.lastName)
  }
}

obj.sayName() // è¾“å‡º 'lin'

function fn(callback) {
  if (typeof callback === 'function') {
    callback()
  }
}

fn(obj.sayName) // è¾“å‡º undefined
```
å¯ä»¥ä½¿ç”¨ call æˆ–è€… apply æ”¹å˜ this æŒ‡å‘ï¼š

```js
const obj = {
  lastName: 'lin',
  sayName() {
    console.log(this.lastName)
  }
}

obj.sayName() // è¾“å‡º 'lin'

function fn(callback, context) { // å®šä¹‰ä¸€ä¸ª context å‚æ•°ï¼Œå¯ä»¥æŠŠä¸Šä¸‹æ–‡ä¼ è¿›å»
  if (typeof callback === 'function') {
    callback.apply(context) // æ˜¾å¼æ”¹å˜ this å€¼ï¼ŒæŒ‡å‘ä¼ å…¥çš„ context
  }
}

fn(obj.sayName, obj) // è¾“å‡º 'lin'
```

### Vue ç”¨ this.$options.data() é‡ç½®ç»„ä»¶ data

ç”¨ `this.$options.data()` é‡ç½®ç»„ä»¶ data æ—¶ï¼Œdata() é‡Œç”¨ this è·å–çš„ props æˆ– method éƒ½ä¸ºundefinedï¼Œä»£ç ç®€åŒ–å¦‚ä¸‹ï¼š

```js
export default {
    props: {
        P: Object
    },
    data () {
        return {
            A: {
                a: this.methodA
            },
            B: this.P
        };
    },
    methods: {
        resetData () { // é‡ç½® data æ—¶è°ƒç”¨
            Object.assign(this.$data, this.$options.data()) // è¿™ä¹ˆå†™å°±ä¼šå‡º bug
        },
        methodA () {
            // do sth.
        },
        methodB () { 
            this.A.a && this.A.a(); // this.A.a is undefined, this.B is undefinedï¼ï¼ï¼
        }
    }
}
```

è°ƒç”¨resetData()ä¹‹åï¼Œå†è°ƒç”¨methodB()æ—¶ï¼Œthis.A.aå’Œthis.Bæ˜¯undefinedã€‚

è§£å†³ï¼ŒresetData é‡Œè¿™ä¹ˆå†™ï¼š

```js
resetData () { 
    Object.assign(this.$data, this.$options.data.call(this))
}
```
è°ƒç”¨ `this.$options.data.call(this)`ï¼Œå°±å¯ä»¥æŠŠ props å’Œ methods æŒ‚è½½ä¸Šå»ã€‚

æˆ‘ä¸ºå•¥è¿è¿™ä¹ˆåçš„çŸ¥è¯†éƒ½çŸ¥é“ï¼Œå› ä¸ºæˆ‘è¸©è¿‡å‘ï¼Œhhhã€‚

è‡³äºä¸ºå•¥è¦è¿™æ ·é‡ç½®ä¸€ä¸ªç»„ä»¶çš„ dataï¼Œå› ä¸ºå®ç°èµ·æ¥ç®€å•ï¼Œå…·ä½“å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š

[Vueä¸­é‡ç½®dataçš„æ•°æ®ä¸ºåˆå§‹çŠ¶æ€](https://blog.csdn.net/weixin_42054155/article/details/99889910)

### è·å–æ•°ç»„æœ€å¤§å€¼ã€æœ€å°å€¼

è¦è·å–ä¸€å †æ•°æ®ä¸­çš„æœ€å¤§å€¼æˆ–è€…æœ€å°å€¼ï¼Œç”¨ Math.max æˆ– Math.min è¦ä¸€ä¸ªä¸€ä¸ªåœ°ä¼ é€’å‚æ•°

è¦è·å–æ•°ç»„ä¸­çš„æœ€å¤§å€¼ï¼Œä½ å¯èƒ½ä¼šè¿™ä¹ˆå†™ï¼š

```js
const arr = [1,2,3,4,5]

function getArrMax (arr) {
  let max = arr[0] 
  for (let i = 0; i < arr.length; i++) {
    if (arr[i] > max) {
      max = arr[i]
    }
  }
  return max
}
console.log(getArrMax(arr)) // 5
```
å®é™…ä¸Šï¼Œç”¨ apply å°±å¯ä»¥å¾ˆå·§å¦™åœ°æŠŠå‚æ•°ä¸€ä¸ªä¸€ä¸ªåœ°ä¼ è¿› Math.max ä¸­å»ï¼š
```js
const arr = [1,2,3,4,5]
console.log(Math.max.apply(Math, arr)) // 5
```
å½“ç„¶ï¼Œes6 ä¹‹åä¹Ÿå¯ä»¥ç”¨è§£æ„èµ‹å€¼è½»æ¾ä¼ å€¼ï¼š

```
const arr = [1,2,3,4,5]
console.log(Math.max(...arr)) // 5
```

### å°†æ•°ç»„å„é¡¹æ·»åŠ åˆ°å¦ä¸€ä¸ªæ•°ç»„

```js
const arr1 = [1, 2, 3]
const arr2 = ['a', 'b', 'c']
```

è¿™æ ·ä¸¤ä¸ªæ•°ç»„ï¼Œå¦‚ä½•æŠŠ arr2 çš„æ•°ç»„é¡¹æ·»åŠ åˆ° arr1ã€‚

ç”¨æ•°ç»„è§£æ„å¯ä»¥è½»æ¾è§£å†³

```js
const arr1 = [1, 2, 3]
const arr2 = ['a', 'b', 'c']

arr1.push(...arr2)
console.log(arr1) // [1,2,3,'a','b','c']
```
ä½†æ˜¯ es6 ä¹‹å‰å¯æ²¡æœ‰è§£æ„èµ‹å€¼ï¼Œæ€ä¹ˆåŠï¼Ÿ

ç”¨ concat ä¸è¡Œï¼Œå› ä¸º concat ä¸èƒ½æ”¹å˜åŸæ•°ç»„ï¼Œéš¾é“åˆè¦ä½¿ç”¨å¾ªç¯äº†å—ï¼Ÿ

å…¶å®å’Œè·å–æ•°ç»„æœ€å¤§å€¼ã€æœ€å°å€¼æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ apply æ¥è§£å†³ã€‚

```js
const arr1 = [1, 2, 3]
const arr2 = ['a', 'b', 'c']

arr1.push.apply(arr1, arr2)

console.log(arr1)
```
åˆ©ç”¨çš„ä¹Ÿæ˜¯ apply å¯ä»¥æŠŠå¤šä¸ªå‚æ•°è½¬åŒ–ä¸ºä¸€ä¸ªå‚æ•°æ•°ç»„çš„åŸç†ã€‚


## bind åº”ç”¨åœºæ™¯

### è§£å†³å¾ªç¯é™·é˜±é—®é¢˜

ä¸€ä¸ªéå¸¸ç»å…¸çš„å¾ªç¯é™·é˜±é—®é¢˜ï¼Œä¸‹é¢è¿™æ®µä»£ç æ‰“å°å‡ºæ¥çš„å€¼éƒ½æ˜¯ 5ã€‚

```js
const arr = []
for (var i = 0; i < 5; i++) {
  arr.push(function () {
    console.log(i)
  })
}

arr[0]() // 5
arr[1]() // 5
arr[2]() // 5
```

è¿™ä¸ªé—®é¢˜é™¤äº†ç”¨é—­åŒ…æ¥è§£å†³ï¼Œä¹Ÿå¯ä»¥ç”¨ bind å‡½æ•°æ¥è§£å†³ã€‚

bind å‡½æ•°å¯ä»¥æ˜¾å¼æ”¹å˜ this æŒ‡å‘ï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæˆ‘ä»¬åˆ©ç”¨ bind å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªæ–°å‡½æ•°çš„ç‰¹æ€§ï¼Œæ¥è§£å†³å¾ªç¯é™·é˜±çš„é—®é¢˜ã€‚

```js
const arr = []
for (var i = 0; i < 5; i++) {
  arr.push(function (i) {
    console.log(i)
  }.bind(this, i)) // ä¸ç”¨æ”¹å˜ this æŒ‡å‘ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯ä¸ºäº†è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°
}

arr[0]() // 0
arr[1]() // 1
arr[2]() // 2
```
å…³äºå¾ªç¯é™·é˜±ï¼Œæ›´å¤šå¯å‚è€ƒæˆ‘çš„è¿™ç¯‡æ–‡ç« ï¼š

[é—­åŒ…ä¸å¾ªç¯é™·é˜±](xxx)

### react çš„ this æŒ‡å‘é—®é¢˜

```js
import React from 'react'

class App extends React.Component{

  handleClick() {
    console.log(this); // è¾“å‡º undefined
  }

  render(){
    return (
      <button onClick={this.handleClick}>
        Click Me
      </button>
    );
  }
}

export default App
```

æ‰§è¡Œ handleClick æ–¹æ³•æ—¶ï¼Œè¾“å‡ºçš„ this æ˜¯ undefinedï¼Œå’Œé¢„æœŸçš„æœ‰ç‚¹ä¸ä¸€æ ·å•Šã€‚


**å¦‚ä½•è§£å†³ this æŒ‡å‘ undefined é—®é¢˜**

å¯ä»¥ä½¿ç”¨ bind æ‰‹åŠ¨ç»‘å®šæˆ–è€…ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚

```js
import React from 'react'
class App extends React.Component{

  handleClick() {
    console.log(this); // è¾“å‡º App
  }

  render(){
    return (
      // ä½¿ç”¨ bind
      <button onClick={this.handleClick.bind(this)}> 
        Click Me
      </button>
    )
  }
}

export default App
```
```js
import React from 'react'
class App extends React.Component{
  
  // ä½¿ç”¨ç®­å¤´å‡½æ•°
  handleClick = () => {
    console.log(this); // è¾“å‡º App
  }

  render(){
    return (
      // ä½¿ç”¨ bind
      <button onClick={this.handleClick}> 
        Click Me
      </button>
    )
  }
}

export default App
```


**ç»“å°¾**

é˜¿æ—æ°´å¹³æœ‰é™ï¼Œæ–‡ä¸­å¦‚æœæœ‰é”™è¯¯æˆ–è¡¨è¾¾ä¸å½“çš„åœ°æ–¹ï¼Œéå¸¸æ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡å‡ºï¼Œæ„Ÿè°¢ï½

å¦‚æœæˆ‘çš„æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä½ çš„ğŸ‘å°±æ˜¯å¯¹æˆ‘çš„æœ€å¤§æ”¯æŒ^_^

ä½ ä¹Ÿå¯ä»¥å…³æ³¨ã€Šå‰ç«¯æ¯æ—¥ä¸€é—®ã€‹è¿™ä¸ªä¸“æ ï¼Œé˜²æ­¢å¤±è”å“¦ï½

æˆ‘æ˜¯é˜¿æ—ï¼Œè¾“å‡ºæ´è§æŠ€æœ¯ï¼Œå†ä¼šï¼

ä¸Šä¸€ç¯‡ï¼š

[ã€Œå‰ç«¯æ¯æ—¥ä¸€é—®ï¼ˆ37ï¼‰ã€callã€apply å’Œ bind çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ](https://github.com/wlllyfor/question-everyday/blob/main/Blog/37.call%E3%80%81apply%20%E5%92%8C%20bind%20%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F.md)

ä¸‹ä¸€ç¯‡ï¼š

[ã€Œå‰ç«¯æ¯æ—¥ä¸€é—®ï¼ˆ39ï¼‰ã€æ‰‹å†™ call å‡½æ•°](https://github.com/wlllyfor/question-everyday/blob/main/Blog/38.%E5%88%97%E4%B8%BE%E4%B8%80%E4%BA%9Bcall%E3%80%81apply%E3%80%81bind%20%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF.md)