æœ¬é¢˜éš¾åº¦ï¼šâ­ â­ 

ç­”ï¼š

é¢å‘å¯¹è±¡è¯­è¨€ä¸­ this è¡¨ç¤ºå½“å‰å¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨ï¼Œè€Œ JS ä¸­çš„ this æ˜¯å®Œå…¨ä¸åŒçš„æ¦‚å¿µã€‚

å¯ä»¥æŠŠJSä¸­çš„ this åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯å…¨å±€ä¸Šä¸‹æ–‡ä¸­çš„ thisï¼Œä¸€ç§æ˜¯å‡½æ•°ä¸Šä¸‹æ–‡ä¸­çš„thisã€‚

å…¨å±€ä¸Šä¸‹æ–‡çš„ this æŒ‡å‘ windowã€‚

å‡½æ•°ä¸Šä¸‹æ–‡çš„ this æŒ‡å‘ä¸æ˜¯å›ºå®šä¸å˜çš„ï¼Œå–å†³äºå‡½æ•°å¤„äºä»€ä¹ˆä½ç½®ã€ä»¥ä»€ä¹ˆæ–¹å¼è°ƒç”¨ï¼Œå¯ä»¥æ€»ç»“æˆå¦‚ä¸‹å›¾ï¼š


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/422bbf9f291d447aa051e61e1598d1d5~tplv-k3u1fbpfcp-watermark.image?)

# å…¨å±€ä¸Šä¸‹æ–‡ä¸­çš„ this

æ— è®ºæ˜¯å¦åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œåœ¨å…¨å±€æ‰§è¡Œç¯å¢ƒä¸­ï¼ˆåœ¨ä»»ä½•å‡½æ•°ä½“å¤–éƒ¨ï¼‰`this`Â éƒ½æŒ‡å‘å…¨å±€å¯¹è±¡ã€‚

```js
console.log(this === window) // true

age = 18
console.log(window.age) // 18

this.name = 'é˜¿æ—'
console.log(window.name) // 'é˜¿æ—'
console.log(name) // 'é˜¿æ—'
```

# å‡½æ•°ä¸Šä¸‹æ–‡ä¸­çš„this

å‡½æ•°ä¸Šä¸‹æ–‡ä¸­çš„ this ä¸ argumentsä¸€æ ·ï¼Œå°±æ˜¯å‡½æ•°çš„éšå¼å‚æ•°ï¼Œå¯ä»¥åœ¨ä»»æ„å‡½æ•°ä¸­è°ƒç”¨ã€‚

å‡½æ•°ä¸­çš„ this çš„å€¼ä¸æ˜¯å›ºå®šä¸å˜çš„ï¼Œå–å†³äºå‡½æ•°**å¤„äºä»€ä¹ˆä½ç½®ã€ä»¥ä»€ä¹ˆæ–¹å¼è°ƒç”¨**ã€‚

## å…¨å±€ä¸Šä¸‹æ–‡ä¸­çš„å‡½æ•°

ç›´æ¥è°ƒç”¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­çš„å‡½æ•°ï¼Œthis æŒ‡å‘é»˜è®¤æƒ…å†µä¸‹ä¸º `window`ã€‚
```js
function fn () {
  console.log(this) // window
}
fn()
```

```js
function fn () {
  var a = 1
  console.log(this.a) // 2
}
var a = 2
fn()
```
ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸º `undefined`
```js
'use strict'

function fn () {
  console.log(this) // undefined
}
fn()
```

## å¯¹è±¡ä¸­çš„å‡½æ•°

è°ƒç”¨å¯¹è±¡ä¸­çš„å‡½æ•°ï¼Œthis æŒ‡å‘ä¸ºè¿™ä¸ªå¯¹è±¡ã€‚
```js
const obj = {
  a: 1,
  fn () {
    console.log('this :>> ', this)
    console.log('this.a :>> ', this.a)
  }
}

obj.fn() 
```

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/49a3e4fd832741debef53ecc7e1fd889~tplv-k3u1fbpfcp-watermark.image?)

ä½†æ˜¯å¦‚æœå‡½æ•°åµŒå¥—æœ‰å‡½æ•°ï¼Œæ­¤æ—¶çš„ this æŒ‡å‘ä¸º windowï¼Œå°±éå¸¸ä»¤äººè¿·æƒ‘ã€‚

```js
const obj = {
  a: 1,
  fn () {
    return function () {
      console.log('this :>> ', this)
      console.log('this.a :>> ', this.a)
    }
  }
}

var a = 100

obj.fn()()
```

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4b866a756a954f5f86cda66f457991c7~tplv-k3u1fbpfcp-watermark.image?)

å…¶å®å¯ä»¥è¿™ä¹ˆç†è§£ï¼š
```js
obj.fn()()

ç­‰ä»·äº

const temp = obj.fn() // å®šä¹‰ä¸€ä¸ªä¸´æ—¶å˜é‡æ¥å­˜å‚¨ obj.fn è¿”å›çš„å‡½æ•°
temp() // æ‰§è¡Œè¿™ä¸ªå‡½æ•°
```
ä¸Šé¢ä»£ç ç¤ºä¾‹ä¸­çš„ temp åœ¨è¿è¡Œæ—¶æ˜¯å¤„åœ¨ window ç¯å¢ƒä¸­çš„ï¼Œæ‰€ä»¥ this æŒ‡å‘ windowã€‚

é‡åˆ°å¯¹è±¡é‡Œæœ‰å‡½æ•°åµŒå¥—å‡½æ•°çš„æƒ…å†µï¼Œæƒ³è¦ this æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œes6ä¹‹å‰ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªä¸´æ—¶å˜é‡ `_this` æ¥æš‚å­˜ thisï¼Œ

```js
const obj = {
  a: 1,
  fn () {
    const _this = this
    return function () {
      console.log('this :>> ', _this)      // è¾“å‡º obj
      console.log('this.a :>> ', _this.a)  // è¾“å‡º 1
    }
  }
}

obj.fn()()
```

## ç®­å¤´å‡½æ•°

æ¥ä¸Šä¾‹ï¼Œå¯¹è±¡é‡Œæœ‰å‡½æ•°åµŒå¥—å‡½æ•°çš„æƒ…å†µï¼Œæƒ³è¦ this æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ç”¨ç®­å¤´å‡½æ•°ã€‚

```js
const obj = {
  a: 1,
  fn () {
    return () => {
      console.log('this :>> ', this)      // è¾“å‡º obj
      console.log('this.a :>> ', this.a)  // è¾“å‡º 1
    }
  }
}

obj.fn()()
```

å¯¹äºæ™®é€šå‡½æ•°æ¥è¯´ï¼Œå†…éƒ¨çš„ `this` æŒ‡å‘å‡½æ•°è¿è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚

å¯¹äºç®­å¤´å‡½æ•°ï¼Œå®ƒä¸ä¼šåˆ›å»ºè‡ªå·±çš„ `this`ï¼Œå®ƒåªä¼š**ä»è‡ªå·±çš„ä½œç”¨åŸŸé“¾çš„ä¸Šä¸€å±‚ç»§æ‰¿ this**ã€‚

æ‰€ä»¥è¿™é‡Œ fn ä¸­åµŒå¥—çš„åŒ¿åç®­å¤´å‡½æ•°ä¸­çš„ thisï¼ŒæŒ‡å‘å®ƒä½œç”¨åŸŸé“¾çš„ä¸Šä¸€å±‚çš„ thisï¼Œä¹Ÿå°±æ˜¯å‡½æ•° fn çš„ thisï¼Œä¹Ÿå°±æ˜¯ objã€‚

å…¶å®ï¼Œç®­å¤´å‡½æ•°å†…éƒ¨å®ç°ä¹Ÿæ˜¯å®šä¹‰ä¸´æ—¶å˜é‡ `_this` æ¥æš‚å­˜ thisï¼Œä¸ä¿¡ä½ ç”¨ `babel` es6 è½¬ es5çœ‹ä¸€çœ‹ï¼š


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9a38531ca5aa4ef4a9d1c7cdbe57e213~tplv-k3u1fbpfcp-watermark.image?)

[babel åœ¨çº¿åœ°å€](https://babel.docschina.org/repl/#?browsers=defaults%2C%20not%20ie%2011%2C%20not%20ie_mob%2011&build=&builtIns=false&spec=false&loose=false&code_lz=Q&debug=false&forceAllTransforms=false&shippedProposals=false&circleciRepo=&evaluate=false&fileSize=false&timeTravel=false&sourceType=module&lineWrap=true&presets=env%2Ces2015%2Creact%2Cstage-2%2Cenv&prettier=false&targets=&version=7.17.8&externalPlugins=)


## æ„é€ å‡½æ•°
æ„é€ å‡½æ•°å†…ï¼Œthis æŒ‡å‘æ–°å»ºçš„å®ä¾‹ã€‚

```js
function Person (name) {
  console.log('this :>> ', this)
  this.name = name
}
const p = new Person('lin')
```

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2a68e087e5a1469b89bc10ebc234df44~tplv-k3u1fbpfcp-watermark.image?)

## å‡½æ•°ä¸­ this çš„å€¼å¯ä»¥æ˜¾å¼æ”¹å˜

å¯ä»¥ä½¿ç”¨ callã€apply å’Œ bind æ¥æ˜¾å¼æ”¹å˜å‡½æ•°ä¸­çš„ this æŒ‡å‘ã€‚

### call 

`Function.prototype.call()`Â æ–¹æ³•ä½¿ç”¨ä¸€ä¸ªæŒ‡å®šçš„Â `this`Â å€¼å’Œå•ç‹¬ç»™å‡ºçš„ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°æ¥è°ƒç”¨ä¸€ä¸ªå‡½æ•°ã€‚

```js
function fn () {
  console.log(this.name)
}

const obj = {
  name: 'é˜¿æ—'
}
fn.call(obj) // æŒ‡å®š this ä¸º objï¼Œè¾“å‡º 'é˜¿æ—'
```

ä½¿ç”¨ call ï¼Œæ”¹å˜æ„é€ å‡½æ•°ä¸­ this çš„æŒ‡å‘ï¼Œå¯ä»¥å®ç°ç»§æ‰¿

```js
function Person (name, age) {
  this.name = name
  this.age = age
}

function Student (name, age, grade) {
  Person.call(this, name, age) // è°ƒç”¨ Person æ„é€ å‡½æ•°ï¼ŒæŒ‡å®š this ä¸º Student å®ä¾‹ï¼Œå®ç°ç»§æ‰¿
  this.grade = grade
}

const s1 = new Student('é˜¿æ—', 18, 100)
console.log(s1)
```

### apply 
`Function.prototype.apply()` æ–¹æ³•è°ƒç”¨ä¸€ä¸ªå…·æœ‰ç»™å®š`this`å€¼çš„å‡½æ•°ï¼Œä»¥åŠä»¥ä¸€ä¸ªæ•°ç»„ï¼ˆæˆ–[ç±»æ•°ç»„å¯¹è±¡](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Indexed_collections#working_with_array-like_objects)ï¼‰çš„å½¢å¼æä¾›çš„å‚æ•°ã€‚

apply å’Œ call çš„åŠŸèƒ½å®Œå…¨ä¸€æ ·ï¼Œåªæ˜¯ä¼ å‚å½¢å¼ä¸ä¸€æ ·ï¼Œcall æ˜¯ä¼ å¤šä¸ªå‚æ•°ï¼Œapply æ˜¯åªä¼ å‚æ•°é›†åˆã€‚

```js
// ä½¿ç”¨ call
function add (x, y, z) {
  return this.x + this.y + this.z
}

const obj = {
  x: 1,
  y: 2,
  z: 3
}

console.log(add.call(obj, 1, 2, 3)) // 6
```

```js
// ä½¿ç”¨ apply
function add (x, y, z) {
  return this.x + this.y + this.z
}

const obj = {
  x: 1,
  y: 2,
  z: 3
}

console.log(add.apply(obj, [1, 2, 3])) // è¾“å‡º 6ï¼Œåªæ˜¯ä¼ å‚å½¢å¼ä¸åŒè€Œå·²
```
### bind

`Function.prototype.bind()`Â æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œåœ¨Â `bind()`Â è¢«è°ƒç”¨æ—¶ï¼Œè¿™ä¸ªæ–°å‡½æ•°çš„Â `this`Â è¢«æŒ‡å®šä¸ºÂ `bind()`Â çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œå…¶ä½™å‚æ•°å°†ä½œä¸ºæ–°å‡½æ•°çš„å‚æ•°ï¼Œä¾›è°ƒç”¨æ—¶ä½¿ç”¨ã€‚

bind å’Œ callã€apply çš„åŒºåˆ«æ˜¯ï¼Œå‡½æ•°è°ƒç”¨ call å’Œ apply ä¼šç›´æ¥è°ƒç”¨ï¼Œè€Œè°ƒç”¨ bind æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¿…é¡»æ‰‹åŠ¨å»å†è°ƒç”¨ä¸€æ¬¡ï¼Œæ‰ä¼šç”Ÿæ•ˆã€‚

```js
function add (x, y, z) {
  return this.x + this.y + this.z
}

const obj = {
  x: 1,
  y: 2,
  z: 3
}

console.log(add.bind(obj, 1, 2, 3)) // è¾“å‡ºåˆ›å»ºçš„å‡½æ•°

const add1 = add.bind(obj, 1, 2, 3)
console.log(add1()) // è¾“å‡º 6
```

**ç»“å°¾**

å…¨å±€ä¸Šä¸‹æ–‡çš„ this æŒ‡å‘ windowã€‚

å‡½æ•°ä¸Šä¸‹æ–‡çš„ this æŒ‡å‘ä¸æ˜¯å›ºå®šä¸å˜çš„ï¼Œå–å†³äºå‡½æ•°å¤„äºä»€ä¹ˆä½ç½®ã€ä»¥ä»€ä¹ˆæ–¹å¼è°ƒç”¨ï¼Œå†çœ‹ä¸€éè¿™å¼ å›¾ï¼ŒåŠ æ·±è®°å¿†ï¼š


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/422bbf9f291d447aa051e61e1598d1d5~tplv-k3u1fbpfcp-watermark.image?)

å¦‚æœæˆ‘çš„æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä½ çš„ğŸ‘å°±æ˜¯å¯¹æˆ‘çš„æœ€å¤§æ”¯æŒ^_^

æˆ‘æ˜¯é˜¿æ—ï¼Œè¾“å‡ºæ´è§æŠ€æœ¯ï¼Œå†ä¼šï¼

ä¸Šä¸€ç¯‡ï¼š

[ã€Œå‰ç«¯æ¯æ—¥ä¸€é—®ï¼ˆ23ï¼‰ã€å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ¯è°ƒç”¨ä¸€æ¬¡ï¼Œå‡½æ•°è¾“å‡ºå€¼ +1](https://github.com/wlllyfor/question-everyday/blob/main/JS/23.%E3%80%8C%E5%89%8D%E7%AB%AF%E6%AF%8F%E6%97%A5%E4%B8%80%E9%97%AE%EF%BC%8823%EF%BC%89%E3%80%8D%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0%EF%BC%8C%E6%AF%8F%E8%B0%83%E7%94%A8%E4%B8%80%E6%AC%A1%EF%BC%8C%E5%87%BD%E6%95%B0%E8%BE%93%E5%87%BA%E5%80%BC%20%2B1.md)

ä¸‹ä¸€ç¯‡ï¼š

[ã€Œå‰ç«¯æ¯æ—¥ä¸€é—®ï¼ˆ25ï¼‰ã€è¯´ä¸€ä¸‹å‡½æ•°å½¢å‚ã€å®å‚ã€å‰©ä½™å‚æ•°ã€é»˜è®¤å‚æ•°ã€éšå¼å‚æ•°](https://github.com/wlllyfor/question-everyday/blob/main/Blog/25.%E8%AF%B4%E4%B8%80%E4%B8%8B%E5%87%BD%E6%95%B0%E5%BD%A2%E5%8F%82%E3%80%81%E5%AE%9E%E5%8F%82%E3%80%81%E5%89%A9%E4%BD%99%E5%8F%82%E6%95%B0%E3%80%81%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0%E3%80%81%E9%9A%90%E5%BC%8F%E5%8F%82%E6%95%B0.md)